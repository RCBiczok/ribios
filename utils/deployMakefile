#!/bin/bash
## Deploy makefile from the template

RIBIOS_HOME=/apps64/bi/ribios
RIBIOS_MAKEFILE=${RIBIOS_HOME}/conf/Makefile-template

PKGS=`find ${RIBIOS_HOME} -maxdepth 1 -mindepth 1 -name "ribios*" ! -name "*.Rcheck" -type d`

for pkg in $PKGS; do
    echo "Processing ${pkg}"
    rm -f ${pkg}/Makefile
    touch ${pkg}/Makefile
    echo "## AUTOMATICALLY GENERATED FROM TEMPLATE (`date`). DO NOT EDIT IT MANUALLY!" > ${pkg}/Makefile
    cd ${pkg}
    git add Makefile; git commit Makefile -m "Makefile updated from the template"
done

exit 0
